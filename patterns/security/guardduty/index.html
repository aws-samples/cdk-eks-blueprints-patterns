
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../encryption-at-rest/">
      
      
        <link rel="next" href="../image-scanning/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>GuardDuty - Amazon EKS Blueprints Patterns</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#amazon-guardduty-protection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Amazon EKS Blueprints Patterns" class="md-header__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon EKS Blueprints Patterns
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GuardDuty
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Amazon EKS Blueprints Patterns" class="md-nav__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon EKS Blueprints Patterns
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generative AI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Generative AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generative-ai/showcase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt Showcase Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Observability Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Observability Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    New Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            New Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-native/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-graviton-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Graviton Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-opensource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-awsnative-fargate-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fargate Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/multi-acc-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Cluster Multi-Region Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-apiserver-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-gpu-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS GPU Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-java-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Java Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/single-new-eks-nginx-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Existing Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Existing Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/existing-eks-awsnative-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/existing-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/existing-eks-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/existing-eks-apiserver-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/existing-eks-nginx-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/multi-account-monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Account Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Security Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Security Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eks-config-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS Config Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encryption-at-rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encryption At Rest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    GuardDuty
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    GuardDuty
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitops-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      GitOps configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deploy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploying-the-guarddutysetupstack-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying the GuardDutySetupStack stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-the-blueprint-workload" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying the blueprint workload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verify" class="md-nav__link">
    <span class="md-ellipsis">
      Verify
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verify">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-guardduty-detector-is-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying that the GuardDuty detector is enabled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-guardduty-runtime-monitoring-agents-are-automatically-deployed" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying that the GuardDuty Runtime Monitoring agents are automatically deployed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../securityhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SecurityHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Batch Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backstage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backstage Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-networking-with-ipv4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customer Network with IPV4 Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instana Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../jupyterhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyterhub Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../knoveyor.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Konveyor Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubeflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeflow Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kubeshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeshark Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pipeline-multi-env-gitops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi environment Pipeline GitOps pattern Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multi-cluster-conformitron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi cluster conformitron pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../secureingresscognito/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Ingress and Authentication Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graviton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graviton Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gmaestro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gMaestro Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitops-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      GitOps configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deploy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploying-the-guarddutysetupstack-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying the GuardDutySetupStack stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploying-the-blueprint-workload" class="md-nav__link">
    <span class="md-ellipsis">
      Deploying the blueprint workload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verify" class="md-nav__link">
    <span class="md-ellipsis">
      Verify
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verify">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-guardduty-detector-is-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying that the GuardDuty detector is enabled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-that-the-guardduty-runtime-monitoring-agents-are-automatically-deployed" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying that the GuardDuty Runtime Monitoring agents are automatically deployed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="amazon-guardduty-protection">Amazon GuardDuty Protection<a class="headerlink" href="#amazon-guardduty-protection" title="Permanent link">¤</a></h1>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">¤</a></h2>
<p>The objective of this pattern is to demonstrate how to enable Amazon GuardDuty Detector across your AWS accounts, use GuardDuty optional features, and how to automate notifications via Amazon SNS based on security findings generated by GuardDuty.</p>
<p>Supported features:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html">Foundational data sources</a> - these data sources are enabled by default, no need to mention them in the pattern input</li>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty-eks-audit-log-monitoring.html">EKS Audit Log Monitoring</a></li>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty-eks-runtime-monitoring.html">EKS Runtime Monitoring</a></li>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/malware-protection.html">Malware Protection in Amazon GuardDuty</a></li>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/rds-protection.html">GuardDuty RDS Protection</a></li>
<li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/s3-protection.html">Amazon S3 Protection in Amazon GuardDuty</a></li>
</ul>
<p>The pattern consists of two components:</p>
<ul>
<li><code>GuardDutySetupStack</code> - enables GuardDuty Detector for the account. The stack also creates an SNS topic, SNS Subscription, and Amazon EventBridge Rule.</li>
<li>A blueprint that deploys a sample GitOps workload that triggers a GuardDuty finding.</li>
</ul>
<p>The list of optional features is adjustable via the <code>features</code> parameter in the <a href="../../../lib/security/guardduty-construct/guardduty-setup.ts">GuardDutySetupStack</a> stack.</p>
<h2 id="gitops-configuration">GitOps configuration<a class="headerlink" href="#gitops-configuration" title="Permanent link">¤</a></h2>
<p>For GitOps, the blueprint bootstraps the ArgoCD addon and points to the <a href="https://github.com/aws-samples/eks-blueprints-workloads">EKS Blueprints Workload</a> sample repository.</p>
<p>The sample repository contains the following workloads:</p>
<ul>
<li><code>team-danger</code> runs a pod in a privileged mode which is a <a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-kubernetes.html#privilegeescalation-kubernetes-privilegedcontainer">security anti-pattern</a></li>
<li><code>team-danger</code> runs a pod with a <a href="https://docs.aws.amazon.com/guardduty/latest/ug/findings-malware-protection.html#execution-malware-kubernetes-maliciousfile">malicious file</a></li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¤</a></h2>
<ol>
<li>Follow the usage <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns/blob/main/README.md#usage">instructions</a> to install the dependencies and perform the repository setup.</li>
<li><code>argo-admin-password</code> secret must be defined in Secrets Manager in the same region as the EKS cluster.</li>
</ol>
<h2 id="deploy">Deploy<a class="headerlink" href="#deploy" title="Permanent link">¤</a></h2>
<p>To bootstrap the CDK toolkit and list all stacks in the app, run the following commands:</p>
<div class="highlight"><pre><span></span><code>cdk<span class="w"> </span>bootstrap
make<span class="w"> </span>list
</code></pre></div>
<h3 id="deploying-the-guarddutysetupstack-stack">Deploying the <code>GuardDutySetupStack</code> stack<a class="headerlink" href="#deploying-the-guarddutysetupstack-stack" title="Permanent link">¤</a></h3>
<p>The <code>GuardDutySetupStack</code> stack enables GuardDuty Detector for the account with all the features of your choice enabled.</p>
<p>To deploy the stack, run the following command:</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>pattern<span class="w"> </span>guardduty<span class="w"> </span>deploy<span class="w"> </span>guardduty-setup
</code></pre></div>
<h3 id="deploying-the-blueprint-workload">Deploying the blueprint workload<a class="headerlink" href="#deploying-the-blueprint-workload" title="Permanent link">¤</a></h3>
<p>The blueprint deploys a sample GitOps workload that triggers a GuardDuty finding.</p>
<p>To deploy the blueprint, run the following command:</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>pattern<span class="w"> </span>guardduty<span class="w"> </span>deploy<span class="w"> </span>guardduty-blueprint
</code></pre></div>
<h2 id="verify">Verify<a class="headerlink" href="#verify" title="Permanent link">¤</a></h2>
<p>Run update-kubeconfig command. You should be able to get the command from CDK output message. More information can be found <a href="https://aws-quickstart.github.io/cdk-eks-blueprints/getting-started/#cluster-access">here</a>. Please replace <code>&lt;your cluster name&gt;</code>, <code>&lt;your region&gt;</code>, and <code>&lt;your cluster role arn&gt;</code> with the values from the CDK output message.</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>eks<span class="w"> </span>update-kubeconfig<span class="w"> </span>--name<span class="w"> </span>&lt;your<span class="w"> </span>cluster<span class="w"> </span>name&gt;<span class="w"> </span>--region<span class="w"> </span>&lt;your<span class="w"> </span>region&gt;<span class="w"> </span>--role-arn<span class="w"> </span>&lt;your<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span>arn&gt;
</code></pre></div>
<h3 id="verifying-that-the-guardduty-detector-is-enabled">Verifying that the GuardDuty detector is enabled<a class="headerlink" href="#verifying-that-the-guardduty-detector-is-enabled" title="Permanent link">¤</a></h3>
<p>Now you can check that the GuardDuty detector is successfully enabled with all the required data sources.</p>
<p>To list all detectors in the region, run the following command:</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>guardduty<span class="w"> </span>list-detectors<span class="w"> </span>--region<span class="w"> </span>us-east-1
</code></pre></div>
<p>The output should look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DetectorIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;80c3c03d44819a984b035b000aa9b3da&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>To check the detector's configuration, run the following command (please replace <code>&lt;DETECTOR-ID&gt;</code> with the ID of the detector):</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>guardduty<span class="w"> </span>get-detector<span class="w"> </span>--detector-id<span class="w"> </span>&lt;DETECTOR-ID&gt;<span class="w"> </span>--region<span class="w"> </span>us-east-1
</code></pre></div>
<p>The output should look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T15:55:27.088Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;FindingPublishingFrequency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SIX_HOURS&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ServiceRole&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:iam::123456789012:role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T15:55:27.088Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DataSources&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;CloudTrail&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;DNSLogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;FlowLogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;S3Logs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;Kubernetes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;AuditLogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;MalwareProtection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;ScanEc2InstanceWithFindings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;EbsVolumes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;ServiceRole&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:iam::123456789012:role/aws-service-role/malware-protection.guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDutyMalwareProtection&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    </span><span class="nt">&quot;Features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CLOUD_TRAIL&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T11:08:44-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DNS_LOGS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T11:08:44-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FLOW_LOGS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T11:08:44-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;S3_DATA_EVENTS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EKS_AUDIT_LOGS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EBS_MALWARE_PROTECTION&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RDS_LOGIN_EVENTS&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EKS_RUNTIME_MONITORING&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;AdditionalConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EKS_ADDON_MANAGEMENT&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-04-14T10:55:27-05:00&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
<span class="w"> </span><span class="err">```</span>

<span class="err">###</span><span class="w"> </span><span class="err">Veri</span><span class="kc">f</span><span class="err">yi</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="kc">t</span><span class="err">ha</span><span class="kc">t</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">GuardDu</span><span class="kc">t</span><span class="err">y</span><span class="w"> </span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gs</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">ge</span><span class="kc">nerate</span><span class="err">d</span>

<span class="err">To</span><span class="w"> </span><span class="err">lis</span><span class="kc">t</span><span class="w"> </span><span class="err">all</span><span class="w"> </span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gs</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">regio</span><span class="kc">n</span><span class="p">,</span><span class="w"> </span><span class="err">ru</span><span class="kc">n</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="kc">f</span><span class="err">ollowi</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">comma</span><span class="kc">n</span><span class="err">d</span><span class="w"> </span><span class="err">(please</span><span class="w"> </span><span class="err">replace</span><span class="w"> </span><span class="err">`&lt;DETECTOR</span><span class="mi">-</span><span class="err">ID&gt;`</span><span class="w"> </span><span class="err">wi</span><span class="kc">t</span><span class="err">h</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">ID</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">de</span><span class="kc">te</span><span class="err">c</span><span class="kc">t</span><span class="err">or)</span><span class="p">:</span>

<span class="err">```bash</span>
<span class="err">aws</span><span class="w"> </span><span class="err">guarddu</span><span class="kc">t</span><span class="err">y</span><span class="w"> </span><span class="err">lis</span><span class="kc">t</span><span class="mi">-</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gs</span><span class="w"> </span><span class="mi">--</span><span class="err">de</span><span class="kc">te</span><span class="err">c</span><span class="kc">t</span><span class="err">or</span><span class="mi">-</span><span class="err">id</span><span class="w"> </span><span class="err">&lt;DETECTOR</span><span class="mi">-</span><span class="err">ID&gt;</span><span class="w"> </span><span class="mi">--</span><span class="err">regio</span><span class="kc">n</span><span class="w"> </span><span class="err">us</span><span class="mf">-e</span><span class="err">as</span><span class="kc">t</span><span class="mi">-1</span>
</code></pre></div>
<p>The output should look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;FindingIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;f2c3859c6ca25b3057d13470a992bbd7&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>To check the finding's details, run the following command (please replace <code>&lt;DETECTOR-ID&gt;</code> and <code>&lt;FINDING-ID&gt;</code> with the ID of the detector and the ID of the finding):</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>guardduty<span class="w"> </span>get-findings<span class="w"> </span>--detector-id<span class="w"> </span>&lt;DETECTOR-ID&gt;<span class="w"> </span>--finding-ids<span class="w"> </span>&lt;FINDING-ID&gt;<span class="w"> </span>--region<span class="w"> </span>us-east-1
</code></pre></div>
<p>The list of findings contains <code>PrivilegeEscalation:Kubernetes/PrivilegedContainer</code> as expected:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;AccountId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123456789012&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Arn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:guardduty:us-east-1:123456789012:detector/94c3858788bc1444ceedab472bab5d7e/finding/f2c3859c6ca25b3057d13470a992bbd7&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-22T21:28:07.748Z&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A privileged container with root level access was launched on EKS Cluster guardduty-blueprint. If this behavior is not expected, it may indicate that your credentials are compromised.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f2c3859c6ca25b3057d13470a992bbd7&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Partition&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;aws&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Region&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;EksClusterDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guardduty-blueprint&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;Arn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arn:aws:eks:us-east-1:123456789012:cluster/guardduty-blueprint&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;VpcId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vpc-02b68c9ddc1d403ab&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ACTIVE&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">                    </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-22T15:48:25.752000-05:00&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;KubernetesDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;KubernetesUserDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;Username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system:serviceaccount:argocd:argocd-application-controller&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Uid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1871d525-442e-487f-ae60-81336d1ff0cf&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                            </span><span class="s2">&quot;system:serviceaccounts&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s2">&quot;system:serviceaccounts:argocd&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s2">&quot;system:authenticated&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nt">&quot;KubernetesWorkloadDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;privileged-pod&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pods&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Uid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;33a3c89e-3280-474d-b8cb-fdf03394fc15&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;argocd&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;HostNetwork&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Containers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                            </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;Image&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;centos&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;ImagePrefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;SecurityContext&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                    </span><span class="nt">&quot;Privileged&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;ResourceType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;EKSCluster&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;SchemaVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Service&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ActionType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;KUBERNETES_API_CALL&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;KubernetesApiCallAction&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;RequestUri&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/api/v1/namespaces/argocd/pods&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;Verb&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;create&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;UserAgent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;argocd-application-controller/v0.0.0 (linux/amd64) kubernetes/$Format&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;RemoteIpDetails&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;City&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;CityName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span>
<span class="w">                            </span><span class="p">},</span>
<span class="w">                            </span><span class="nt">&quot;Country&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                            </span><span class="nt">&quot;GeoLocation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;Lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;Lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">                            </span><span class="p">},</span>
<span class="w">                            </span><span class="nt">&quot;IpAddressV4&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.205.129&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="nt">&quot;Organization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nt">&quot;Asn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;AsnOrg&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;Isp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="nt">&quot;Org&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="nt">&quot;StatusCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">201</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;Archived&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;Count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;DetectorId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;94c3858788bc1444ceedab472bab5d7e&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;EventFirstSeen&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-22T21:27:18.186Z&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;EventLastSeen&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-22T21:27:18.630Z&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;ResourceRole&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TARGET&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guardduty&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;AdditionalInfo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;Value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{}&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;Severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Privileged container with root level access launched on the EKS Cluster.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PrivilegeEscalation:Kubernetes/PrivilegedContainer&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-22T21:28:07.748Z&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="verifying-that-the-guardduty-runtime-monitoring-agents-are-automatically-deployed">Verifying that the GuardDuty Runtime Monitoring agents are automatically deployed<a class="headerlink" href="#verifying-that-the-guardduty-runtime-monitoring-agents-are-automatically-deployed" title="Permanent link">¤</a></h3>
<p>To verify that the GuardDuty Runtime Monitoring agents are automatically deployed, run the following command:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-A
</code></pre></div>
<p>The output should look like this:</p>
<div class="highlight"><pre><span></span><code>NAMESPACE<span class="w">          </span>NAME<span class="w">                                                              </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">        </span>AGE
amazon-guardduty<span class="w">   </span>aws-guardduty-agent-qrm22<span class="w">                                         </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>25m
argocd<span class="w">             </span>blueprints-addon-argocd-application-controller-0<span class="w">                  </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-applicationset-controller-7c4c75877579s<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-dex-server-c6687d84f-q4697<span class="w">                </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>3m21s<span class="w"> </span>ago<span class="o">)</span><span class="w">   </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-notifications-controller-7c74f76c5wh4nb<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-redis-595cc69fff-9985j<span class="w">                    </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-repo-server-7f75c7796c-229c4<span class="w">              </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>blueprints-addon-argocd-server-86867c9dd8-p6qk7<span class="w">                   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>3m25s
argocd<span class="w">             </span>privileged-pod<span class="w">                                                    </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>115s
kube-system<span class="w">        </span>aws-node-4lhp7<span class="w">                                                    </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>26m
kube-system<span class="w">        </span>coredns-79989457d9-jncrb<span class="w">                                          </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>32m
kube-system<span class="w">        </span>coredns-79989457d9-l5jcg<span class="w">                                          </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>32m
kube-system<span class="w">        </span>kube-proxy-hwkwm<span class="w">                                                  </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">               </span>26m
</code></pre></div>
<p>As you can see, the GuardDuty Runtime Monitoring agent is deployed in the <code>amazon-guardduty</code> namespace.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["tabs"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>