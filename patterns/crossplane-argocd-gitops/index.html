
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>GitOps based Multi-cluster add-on and Apps Management using Crossplane and ArgoCD - Amazon EKS Blueprints Patterns</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gitops-based-multi-cluster-add-on-and-apps-management-using-crossplane-and-argocd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amazon EKS Blueprints Patterns" class="md-header__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon EKS Blueprints Patterns
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GitOps based Multi-cluster add-on and Apps Management using Crossplane and ArgoCD
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amazon EKS Blueprints Patterns" class="md-nav__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon EKS Blueprints Patterns
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generative AI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Generative AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generative-ai/showcase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt Showcase Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Observability Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Observability Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    New Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            New Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-native/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-graviton-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Graviton Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-opensource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-awsnative-fargate-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fargate Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/multi-acc-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Cluster Multi-Region Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-apiserver-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-gpu-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS GPU Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-java-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Java Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-nginx-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Existing Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Existing Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-awsnative-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-apiserver-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-nginx-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/multi-account-monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Account Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Security Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Security Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/eks-config-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS Config Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/encryption-at-rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encryption At Rest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/guardduty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GuardDuty
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/image-scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/securityhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SecurityHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Batch Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backstage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backstage Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-networking-with-ipv4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customer Network with IPV4 Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instana Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jupyterhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyterhub Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../knoveyor.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Konveyor Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubeflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeflow Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubeshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeshark Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline-multi-env-gitops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi environment Pipeline GitOps pattern Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-cluster-conformitron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi cluster conformitron pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secureingresscognito/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Ingress and Authentication Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graviton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graviton Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gmaestro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gMaestro Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitops-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      GitOps Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-aws-secret-manager-secret" class="md-nav__link">
    <span class="md-ellipsis">
      Create AWS Secret Manager Secret
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-access" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-the-codepipeline" class="md-nav__link">
    <span class="md-ellipsis">
      View the CodePipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-the-management-eks-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Access the Management EKS cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-to-the-workload-clusters-using-iam-role-eks-workload-connector-role" class="md-nav__link">
    <span class="md-ellipsis">
      Access to the Workload clusters using IAM role eks-workload-connector-role
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-the-workload-eks-cluster-workload-amd-1-29-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      Access the Workload EKS cluster workload-amd-1-29-blueprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-the-workload-eks-cluster-workload-arm-1-29-blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      Access the Workload EKS cluster workload-arm-1-29-blueprint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    <span class="md-ellipsis">
      Test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-the-argocd-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Install the ArgoCD CLI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-eks-add-ons-deployment-in-workload-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Validate EKS add-ons deployment in Workload Clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-kubernetes-manifests-deployment-in-workload-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Validate Kubernetes Manifests deployment in Workload clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-helm-chart-deployment-in-workload-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Validate Helm Chart deployment in Workload clusters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="gitops-based-multi-cluster-add-on-and-apps-management-using-crossplane-and-argocd">GitOps based Multi-cluster add-on and Apps Management using Crossplane and ArgoCD<a class="headerlink" href="#gitops-based-multi-cluster-add-on-and-apps-management-using-crossplane-and-argocd" title="Permanent link">¤</a></h1>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">¤</a></h2>
<p>The objective of this pattern is to provide centralized management of Amazon EKS add-ons, Kubernetes Applications and Helm charts in workload clusters. This approach consists of a Management Cluster and multiple workload clusters. The Management Cluster is created with ArgoCD and Crossplane add-ons. The platform team creates Crossplane Manifest files for Amazon EKS add-ons/Kubernetes Applications/Helm charts and pushes them to the GitOps Repo. The ArgoCD Application Controller in the Management Cluster reconciles these Crossplane Manifests and deploy them into Management Cluster.  The Crossplane Controller in the Management Cluster deploys the Amazon EKS add-ons/Kubernetes Applications/Helm charts into the Workload Clusters.</p>
<p>This helps platform teams to simplify the process of deploying add-ons and Apps from a central Management Cluster. In this Solution, we use CDK to deploy AWS CodePipeline which monitors this platform repo and deploy the Management and Workload Clusters using CDK EKS Blueprints.</p>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">¤</a></h2>
<p><img alt="crossplane-argocd-gitops" src="../images/crossplane-argocd-gitops.png" /></p>
<h2 id="approach">Approach<a class="headerlink" href="#approach" title="Permanent link">¤</a></h2>
<p>This blueprint will include the following:</p>
<ul>
<li>AWS CodePipeline which deploys the Management and Workload Clusters</li>
<li>A new Well-Architected EKS cluster <code>eks-mgmt-cluster</code> and two workload EKS Clusters <code>workload-amd-1-29-blueprint</code> and <code>workload-arm-1-29-blueprint</code> in the region and account you specify.</li>
<li><a href="https://docs.aws.amazon.com/eks/latest/userguide/managing-vpc-cni.html">Amazon VPC CNI add-on (VpcCni)</a> into your cluster to support native VPC networking for Amazon EKS.</li>
<li>The Management Cluster is deployed with the following add-ons.<ul>
<li>Upbound Universal Crossplane Provider</li>
<li>Upbound AWS Family Crossplane Provider</li>
<li>Upbound AWS EKS Crossplane Provider</li>
<li>Kubernetes Crossplane Provider</li>
<li>Helm Crossplane Provider</li>
<li>Secrets Store AddOn</li>
<li>ArgoCD add-on</li>
</ul>
</li>
<li>The ArgoCD add-on is bootstrapped with <a href="https://github.com/aws-samples/eks-blueprints-workloads">GitOps</a> which contains Crossplane Manifest files to deploy EKS add-ons, Kubernetes Manifests and also Helm Charts.</li>
</ul>
<h2 id="gitops-configuration">GitOps Configuration<a class="headerlink" href="#gitops-configuration" title="Permanent link">¤</a></h2>
<p>For GitOps, the blueprint bootstrap the ArgoCD add-on and points to the <a href="https://github.com/aws-samples/eks-blueprints-workloads">EKS Blueprints Workload</a> sample repository.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¤</a></h2>
<p>Ensure that you have installed the following tools on your machine.</p>
<ol>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html">aws cli</a></li>
<li><a href="https://Kubernetes.io/docs/tasks/tools/">kubectl</a></li>
<li><a href="https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html#getting_started_install">cdk</a></li>
<li><a href="https://docs.npmjs.com/cli/v8/commands/npm-install">npm</a></li>
<li><a href="https://helm.sh/docs/intro/install/">helm</a></li>
<li>GitHub Access Token for this repo and AWS secret</li>
</ol>
<h3 id="create-aws-secret-manager-secret">Create AWS Secret Manager Secret<a class="headerlink" href="#create-aws-secret-manager-secret" title="Permanent link">¤</a></h3>
<p>Create a plain-text Amazon secret to hold a fine-grained GitHub access token for this repo in the desired region, and
set its name as a value to the GITHUB_SECRET environment variable. Default value is <code>cdk_blueprints_github_secret</code>.</p>
<blockquote>
<p><strong>WARNING:</strong> When switching the CDK between region, remember to replicate this secret!!!!</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ACCOUNT_ID</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>sts<span class="w"> </span>get-caller-identity<span class="w"> </span>--output<span class="w"> </span>text<span class="w"> </span>--query<span class="w"> </span>Account<span class="k">)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">AWS_REGION</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CDK_REPO_GITHUB_PAT_TOKEN</span><span class="o">=</span>&lt;set_token_here&gt;
<span class="nb">export</span><span class="w"> </span><span class="nv">CDK_REPO_AWS_SECRET_NAME</span><span class="o">=</span><span class="s2">&quot;cdk_blueprints_github_secret&quot;</span>
aws<span class="w"> </span>secretsmanager<span class="w"> </span>create-secret<span class="w"> </span>--region<span class="w"> </span><span class="nv">$AWS_REGION</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span><span class="nv">$CDK_REPO_AWS_SECRET_NAME</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--description<span class="w"> </span><span class="s2">&quot;GitHub Personal Access Token for CodePipeline to access GitHub account&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--secret-string<span class="w"> </span><span class="nv">$CDK_REPO_GITHUB_PAT_TOKEN</span>
</code></pre></div>
<h2 id="deploy">Deploy<a class="headerlink" href="#deploy" title="Permanent link">¤</a></h2>
<ol>
<li>Clone the repository and install dependency packages. This repository contains CDK v2 code written in TypeScript.</li>
</ol>
<div class="highlight"><pre><span></span><code>git clone https://github.com/aws-samples/cdk-eks-blueprints-patterns.git
cd cdk-eks-blueprints-patterns
npm i
</code></pre></div>
<ol>
<li>Execute the commands below to bootstrap the AWS environment</li>
</ol>
<div class="highlight"><pre><span></span><code>cdk bootstrap aws://$ACCOUNT_ID/$AWS_REGION
</code></pre></div>
<ol>
<li>Run the following command from the root of this repository to deploy the pipeline stack:</li>
</ol>
<div class="highlight"><pre><span></span><code>make clean
make build
make list
make pattern crossplane-argocd-gitops deploy
</code></pre></div>
<h2 id="cluster-access">Cluster Access<a class="headerlink" href="#cluster-access" title="Permanent link">¤</a></h2>
<h3 id="view-the-codepipeline">View the CodePipeline<a class="headerlink" href="#view-the-codepipeline" title="Permanent link">¤</a></h3>
<p><img alt="codepipeline1" src="../images/codepipeline1.png" /></p>
<p><img alt="codepipeline2" src="../images/codepipeline2.png" /></p>
<h3 id="access-the-management-eks-cluster">Access the Management EKS cluster<a class="headerlink" href="#access-the-management-eks-cluster" title="Permanent link">¤</a></h3>
<p>In this section, let us create a kube-context for the Management cluster and ensure that the ArgoCD and Crossplane add-ons are deployed successfully.</p>
<ol>
<li>Run the below command to get the AWS command from CloudFormation Stack <code>eks-mgmt-cluster-stage-eks-mgmt-cluster-stage-blueprint</code> outputs</li>
</ol>
<p>The example command looks like below.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">CFNOutputKey</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>cloudformation<span class="w"> </span>describe-stacks<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--stack-name<span class="w"> </span>eks-mgmt-cluster-stage-eks-mgmt-cluster-stage-blueprint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--query<span class="w"> </span><span class="s1">&#39;Stacks[].Outputs[].OutputKey&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.[]|select(. | startswith(&quot;mgmtclusterstageblueprintConfigCommand&quot;))&#39;</span><span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$CFNOutputKey</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">mgmtclusterstageblueprintConfigCommand</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>cloudformation<span class="w"> </span>describe-stacks<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--stack-name<span class="w"> </span>eks-mgmt-cluster-stage-eks-mgmt-cluster-stage-blueprint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--query<span class="w"> </span><span class="s1">&#39;Stacks[].Outputs[?OutputKey==`&#39;</span><span class="nv">$CFNOutputKey</span><span class="s1">&#39;`].OutputValue&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>--output<span class="w"> </span>text<span class="k">)</span>
<span class="nb">echo</span><span class="w">  </span><span class="nv">$mgmtclusterstageblueprintConfigCommand</span>
</code></pre></div>
<ol>
<li>Run below command to create the kube-context for the Management cluster.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nv">$mgmtclusterstageblueprintConfigCommand</span>
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>Updated<span class="w"> </span>context<span class="w"> </span>arn:aws:eks:us-west-2:ACCOUNT_ID:cluster/eks-eks-mgmt-cluster<span class="w"> </span><span class="k">in</span><span class="w"> </span>/Users/&lt;user_name&gt;/.kube/config
</code></pre></div>
<ol>
<li>Copy the context in the output above and set an environment variable </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANAGEMENT_CLUSTER_CONTEXT</span><span class="o">=</span><span class="s2">&quot;arn:aws:eks:</span><span class="si">${</span><span class="nv">AWS_REGION</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">ACCOUNT_ID</span><span class="si">}</span><span class="s2">:cluster/eks-eks-mgmt-cluster&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export  MANAGEMENT_CLUSTER_CONTEXT=</span><span class="si">${</span><span class="nv">MANAGEMENT_CLUSTER_CONTEXT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bash_profile
</code></pre></div>
<ol>
<li>Run below command to validate the access to the cluster</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>node
</code></pre></div>
<p>The output will like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                           </span>STATUS<span class="w">   </span>ROLES<span class="w">    </span>AGE<span class="w">   </span>VERSION
ip-10-0-137-3.ec2.internal<span class="w">     </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">   </span>18h<span class="w">   </span>v1.29.6-eks-1552ad0
ip-10-0-169-194.ec2.internal<span class="w">   </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">   </span>18h<span class="w">   </span>v1.29.6-eks-1552ad0
</code></pre></div>
<ol>
<li>Run below command to get the list of Crossplane Providers deployed in the cluster</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>providers.pkg.crossplane.io
</code></pre></div>
<p>The output will like below.</p>
<p><div class="highlight"><pre><span></span><code>NAME<span class="w">                          </span>INSTALLED<span class="w">   </span>HEALTHY<span class="w">   </span>PACKAGE<span class="w">                                                          </span>AGE
helm-provider<span class="w">                 </span>True<span class="w">        </span>True<span class="w">      </span>xpkg.upbound.io/crossplane-contrib/provider-helm:v0.19.0<span class="w">         </span>18h
kubernetes-provider<span class="w">           </span>True<span class="w">        </span>True<span class="w">      </span>xpkg.upbound.io/crossplane-contrib/provider-kubernetes:v0.13.0<span class="w">   </span>18h
provider-aws-eks<span class="w">              </span>True<span class="w">        </span>True<span class="w">      </span>xpkg.upbound.io/upbound/provider-aws-eks:v1.1.0<span class="w">                  </span>18h
upbound-provider-family-aws<span class="w">   </span>True<span class="w">        </span>True<span class="w">      </span>xpkg.upbound.io/upbound/provider-family-aws:v1.13.0<span class="w"> </span>
</code></pre></div>
6. Run below command to get the Crossplane Providers pods in the <code>upbound-system</code> Namespace.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-n<span class="w"> </span>upbound-system
</code></pre></div>
<p>The output will like below.</p>
<p><div class="highlight"><pre><span></span><code>NAME<span class="w">                                                        </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">   </span>AGE
crossplane-594b65bfdb-pgkxf<span class="w">                                 </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>6d8h
crossplane-rbac-manager-86c74cf5d-tjcw8<span class="w">                     </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>6d8h
helm-provider-4d90a08b9ede-7c874b858b-pp26d<span class="w">                 </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>47h
kubernetes-provider-a3cbbe355fa7-55846cfbfb-6tpcl<span class="w">           </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>25h
provider-aws-eks-23042d28ed58-66d9db8476-jr6mb<span class="w">              </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>6d8h
upbound-provider-family-aws-bac5d48bd353-64845bdcbc-4vpn6<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>6d8h<span class="w">            </span>8d
</code></pre></div>
7. Run below command to get the ArgoCD pods deployed in the <code>argocd</code> Namespace.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>pod<span class="w"> </span>-n<span class="w"> </span>argocd
</code></pre></div>
<p>The output will like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                                              </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">       </span>AGE
blueprints-addon-argocd-application-controller-0<span class="w">                  </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
blueprints-addon-argocd-applicationset-controller-7b78c7fc94ls9<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
blueprints-addon-argocd-dex-server-6cf94ddc54-dfhv7<span class="w">               </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
blueprints-addon-argocd-notifications-controller-6f6b7d95cdd2tl<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
blueprints-addon-argocd-redis-b8dbc7dc6-h4bs8<span class="w">                     </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
blueprints-addon-argocd-repo-server-fd57dc686-zkbsm<span class="w">               </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>4h15m
blueprints-addon-argocd-server-84c8b597c9-98c95<span class="w">                   </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">              </span>24h
</code></pre></div>
<h3 id="access-to-the-workload-clusters-using-iam-role-eks-workload-connector-role">Access to the Workload clusters using IAM role <code>eks-workload-connector-role</code><a class="headerlink" href="#access-to-the-workload-clusters-using-iam-role-eks-workload-connector-role" title="Permanent link">¤</a></h3>
<p>Note that we create and add an IAM role eks-workload-connector-role with system:masters RBAC access to both of the workload clusters i.e. workload-amd-1-29-blueprint and workload-arm-1-29-blueprint as part of the Stack creation.</p>
<p>The Upbound AWS EKS Provider Pod will use its IRSA role to assume the <code>eks-workload-connector-role</code> to gain access to the workload clusters. The <code>sts:AssumeRole</code> IAM permission is already added to the IRSA role during the Management cluster creation.</p>
<p>We will create two Crossplane objects of type <code>ClusterAuth</code> to create kube-context to access the Workload clusters using the IAM role <code>eks-workload-connector-role</code></p>
<p>We will also create two Crossplane objects of type <code>Addon</code> to deploy Amazon EKS add-ons into the Workload clusters. To deploy add-ons, the AWS EKS Provider Pod needs <code>eks:*</code> IAM permissions, which are already added to <code>eks-workload-connector-role</code> during cluster creation.</p>
<p>Note this IAM permissions can be made very granular to provide least privileged access to workload clusters.</p>
<h3 id="access-the-workload-eks-cluster-workload-amd-1-29-blueprint">Access the Workload EKS cluster <code>workload-amd-1-29-blueprint</code><a class="headerlink" href="#access-the-workload-eks-cluster-workload-amd-1-29-blueprint" title="Permanent link">¤</a></h3>
<p>In this section, let us create a kube-context and verify access to the Workload cluster <code>workload-amd-1-29-blueprint</code></p>
<blockquote>
<p>Note that we have added an IAM role eks-workload-connector-role with system:masters RBAC access to both of the workload clusters i.e. workload-amd-1-29-blueprint and workload-arm-1-29-blueprint.</p>
</blockquote>
<ol>
<li>Run the command to create the kube-context for the cluster.</li>
</ol>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>eks<span class="w"> </span>update-kubeconfig<span class="w"> </span>--name<span class="w"> </span>workload-amd-1-29-blueprint<span class="w"> </span>--region<span class="w"> </span><span class="si">${</span><span class="nv">AWS_REGION</span><span class="si">}</span><span class="w"> </span>--role-arn<span class="w"> </span><span class="s2">&quot;arn:aws:iam::</span><span class="si">${</span><span class="nv">ACCOUNT_ID</span><span class="si">}</span><span class="s2">:role/eks-workload-connector-role&quot;</span>
</code></pre></div>
<ol>
<li>Copy the context in the output above and set an environment variable.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKLOAD_CLUSTER1_CONTEXT</span><span class="o">=</span><span class="s2">&quot;arn:aws:eks:</span><span class="si">${</span><span class="nv">AWS_REGION</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">ACCOUNT_ID</span><span class="si">}</span><span class="s2">:cluster/workload-amd-1-29-blueprint&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export  WORKLOAD_CLUSTER1_CONTEXT=</span><span class="si">${</span><span class="nv">WORKLOAD_CLUSTER1_CONTEXT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bash_profile
</code></pre></div>
3. Run below command to validate the access to the cluster.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>--context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER1_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>node
</code></pre></div>
<h3 id="access-the-workload-eks-cluster-workload-arm-1-29-blueprint">Access the Workload EKS cluster <code>workload-arm-1-29-blueprint</code><a class="headerlink" href="#access-the-workload-eks-cluster-workload-arm-1-29-blueprint" title="Permanent link">¤</a></h3>
<p>In this section, let us create a kube-context and verify access to the Workload cluster <code>workload-arm-1-29-blueprint</code></p>
<blockquote>
<p>Note that we have added an IAM role eks-workload-connector-role with system:masters RBAC access to both of the workload clusters i.e. workload-amd-1-29-blueprint and workload-arm-1-29-blueprint.</p>
</blockquote>
<ol>
<li>Run the command to create the kube-context for the cluster.</li>
</ol>
<p><div class="highlight"><pre><span></span><code>aws<span class="w"> </span>eks<span class="w"> </span>update-kubeconfig<span class="w"> </span>--name<span class="w"> </span>workload-arm-1-29-blueprint<span class="w"> </span>--region<span class="w"> </span><span class="si">${</span><span class="nv">AWS_REGION</span><span class="si">}</span><span class="w"> </span>--role-arn<span class="w"> </span><span class="s2">&quot;arn:aws:iam::</span><span class="si">${</span><span class="nv">ACCOUNT_ID</span><span class="si">}</span><span class="s2">:role/eks-workload-connector-role&quot;</span>
</code></pre></div>
2. Copy the context in the output above and set an environment variable.</p>
<p><div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKLOAD_CLUSTER2_CONTEXT</span><span class="o">=</span><span class="s2">&quot;arn:aws:eks:</span><span class="si">${</span><span class="nv">AWS_REGION</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">ACCOUNT_ID</span><span class="si">}</span><span class="s2">:cluster/workload-arm-1-29-blueprint&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export  WORKLOAD_CLUSTER2_CONTEXT=</span><span class="si">${</span><span class="nv">WORKLOAD_CLUSTER1_CONTEXT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bash_profile
</code></pre></div>
3. Run below command to validate the access to the cluster.</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>--context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER1_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>node
</code></pre></div>
<h2 id="test">Test<a class="headerlink" href="#test" title="Permanent link">¤</a></h2>
<h3 id="install-the-argocd-cli">Install the ArgoCD CLI<a class="headerlink" href="#install-the-argocd-cli" title="Permanent link">¤</a></h3>
<ol>
<li>
<p>Install the ArgoCD CLI as per the <a href="https://argo-cd.readthedocs.io/en/stable/cli_installation/">docs</a></p>
</li>
<li>
<p>Get the ArgoCD Admin password using below command.</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w">  </span>-n<span class="w"> </span>argocd<span class="w"> </span>get<span class="w"> </span>secret<span class="w"> </span>argocd-initial-admin-secret<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s2">&quot;{.data.password}&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="p">;</span><span class="w"> </span><span class="nb">echo</span>
</code></pre></div>
<ol>
<li>Open a <strong>New Terminal</strong> and Run a local proxy server for the ArgoCD Server.</li>
</ol>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>port-forward<span class="w"> </span>svc/blueprints-addon-argocd-server<span class="w"> </span>-n<span class="w"> </span>argocd<span class="w"> </span><span class="m">8080</span>:443
</code></pre></div>
4. In the current Terminal run the ArgoCD login command.</p>
<div class="highlight"><pre><span></span><code>argocd<span class="w"> </span>login<span class="w"> </span>localhost:8080<span class="w"> </span>--username<span class="w"> </span>admin<span class="w"> </span>--password<span class="w"> </span>&lt;admin_password&gt;
</code></pre></div>
<ol>
<li>Add Management EKS cluster to ArgoCD.</li>
</ol>
<p><div class="highlight"><pre><span></span><code>argocd<span class="w"> </span>cluster<span class="w"> </span>add<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span>
</code></pre></div>
The output will look like below.</p>
<div class="highlight"><pre><span></span><code>WARNING:<span class="w"> </span>This<span class="w"> </span>will<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="sb">`</span>argocd-manager<span class="sb">`</span><span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>cluster<span class="w"> </span>referenced<span class="w"> </span>by<span class="w"> </span>context<span class="w"> </span><span class="sb">`</span>arn:aws:eks:us-west-2:ACCOUNT_ID:cluster/eks-mgmt-cluster<span class="sb">`</span><span class="w"> </span>with<span class="w"> </span>full<span class="w"> </span>cluster<span class="w"> </span>level<span class="w"> </span>privileges.<span class="w"> </span>Do<span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="o">[</span>y/N<span class="o">]</span>?<span class="w"> </span>y
INFO<span class="o">[</span><span class="m">0004</span><span class="o">]</span><span class="w"> </span>ServiceAccount<span class="w"> </span><span class="s2">&quot;argocd-manager&quot;</span><span class="w"> </span>already<span class="w"> </span>exists<span class="w"> </span><span class="k">in</span><span class="w"> </span>namespace<span class="w"> </span><span class="s2">&quot;kube-system&quot;</span><span class="w"> </span>
INFO<span class="o">[</span><span class="m">0004</span><span class="o">]</span><span class="w"> </span>ClusterRole<span class="w"> </span><span class="s2">&quot;argocd-manager-role&quot;</span><span class="w"> </span>updated<span class="w">    </span>
INFO<span class="o">[</span><span class="m">0005</span><span class="o">]</span><span class="w"> </span>ClusterRoleBinding<span class="w"> </span><span class="s2">&quot;argocd-manager-role-binding&quot;</span><span class="w"> </span>updated<span class="w"> </span>
Cluster<span class="w"> </span><span class="s1">&#39;https://0F745A41ECA76297CBF070C032932033.sk1.us-west-2.eks.amazonaws.com&#39;</span><span class="w"> </span>added
</code></pre></div>
<ol>
<li>Run the below command to get the list of ArgoCD Applications.</li>
</ol>
<div class="highlight"><pre><span></span><code>argocd<span class="w"> </span>app<span class="w"> </span>list
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                   </span>CLUSTER<span class="w">                         </span>NAMESPACE<span class="w">  </span>PROJECT<span class="w">  </span>STATUS<span class="w">  </span>HEALTH<span class="w">   </span>SYNCPOLICY<span class="w">  </span>CONDITIONS<span class="w">  </span>REPO<span class="w">                                                        </span>PATH<span class="w">                      </span>TARGET
argocd/bootstrap-apps<span class="w">  </span>https://kubernetes.default.svc<span class="w">  </span>argocd<span class="w">     </span>default<span class="w">  </span>Synced<span class="w">  </span>Healthy<span class="w">  </span>Auto-Prune<span class="w">  </span>&lt;none&gt;<span class="w">      </span>https://github.com/aws-samples/eks-blueprints-workloads<span class="w">  </span>./crossplane-argocd-gitops/envs/dev<span class="w">  </span>main
argocd/team-spock<span class="w">        </span>https://kubernetes.default.svc<span class="w">  </span>argocd<span class="w">     </span>default<span class="w">  </span>Synced<span class="w">  </span>Healthy<span class="w">  </span>Auto-Prune<span class="w">  </span>&lt;none&gt;<span class="w">      </span>https://github.com/aws-samples/eks-blueprints-workloads<span class="w">  </span>./teams/team-spock/dev<span class="w">        </span>main
</code></pre></div>
<h3 id="validate-eks-add-ons-deployment-in-workload-clusters">Validate EKS add-ons deployment in Workload Clusters<a class="headerlink" href="#validate-eks-add-ons-deployment-in-workload-clusters" title="Permanent link">¤</a></h3>
<ol>
<li>Run the below command to get the list of <code>ProviderConfig</code> Crossplane CRD objects deployed in the Management cluster</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>providerconfigs.aws.upbound.io
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                         </span>AGE
common-provider-config-aws<span class="w">   </span>23h
</code></pre></div>
<ol>
<li>Run the below command to get the list of <code>Addon</code> Objects deployed in the Management cluster. </li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>addons.eks.aws.upbound.io
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                    </span>READY<span class="w">   </span>SYNCED<span class="w">   </span>EXTERNAL-NAME<span class="w">                               </span>AGE
addon-eks-pod-identity-agent-amd-1-29<span class="w">   </span>True<span class="w">    </span>True<span class="w">     </span>workload-amd-1-29-blueprint:eks-pod-identity-agent<span class="w">   </span>4h15m
addon-eks-pod-identity-agent-arm-1-29<span class="w">   </span>True<span class="w">    </span>True<span class="w">     </span>workload-arm-1-29-blueprint:eks-pod-identity-agent<span class="w">   </span>4h15m
</code></pre></div>
<ol>
<li>Go to the Workload EKS Clusters and Ensure that EKS add-on is deployed successfully.</li>
</ol>
<p><img alt="workload-amd-1-29-blueprint EKS add-on" src="../images/amd-add-on.png" /></p>
<p><img alt="workload-arm-1-29-blueprint EKS add-on" src="../images/arm-add-on.png" /></p>
<h3 id="validate-kubernetes-manifests-deployment-in-workload-clusters">Validate Kubernetes Manifests deployment in Workload clusters<a class="headerlink" href="#validate-kubernetes-manifests-deployment-in-workload-clusters" title="Permanent link">¤</a></h3>
<ol>
<li>Run the below command to get the list of Crossplane Kubernetes <code>ProviderConfig</code> objects deployed in the Management cluster.</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>providerconfigs.kubernetes.crossplane.io
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                     </span>AGE
provider-config-k8s-workload-amd-1-29-blueprint<span class="w">   </span>4h31m
provider-config-k8s-workload-arm-1-29-blueprint<span class="w">   </span>4h40m
</code></pre></div>
<ol>
<li>Run the below command to get the list of Namespaces in the Workload cluster  <code>workload-amd-1-29-blueprint</code></li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER1_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>ns
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                </span>STATUS<span class="w">   </span>AGE
default<span class="w">                             </span>Active<span class="w">   </span>8d
external-secrets<span class="w">                    </span>Active<span class="w">   </span>8d
kube-node-lease<span class="w">                     </span>Active<span class="w">   </span>8d
kube-public<span class="w">                         </span>Active<span class="w">   </span>8d
kube-system<span class="w">                         </span>Active<span class="w">   </span>8d
test-namespace-workload-amd-1-29-blueprint<span class="w">   </span>Active<span class="w">   </span>4h9m
</code></pre></div>
<ol>
<li>Run the below command to get the list of Namespaces in the Workload cluster  <code>workload-arm-1-29-blueprint</code></li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER2_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>ns
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                </span>STATUS<span class="w">   </span>AGE
default<span class="w">                             </span>Active<span class="w">   </span>8d
external-secrets<span class="w">                    </span>Active<span class="w">   </span>8d
kube-node-lease<span class="w">                     </span>Active<span class="w">   </span>8d
kube-public<span class="w">                         </span>Active<span class="w">   </span>8d
kube-system<span class="w">                         </span>Active<span class="w">   </span>8d
test-namespace-workload-arm-1-29-blueprint<span class="w">   </span>Active<span class="w">   </span>4h9m
</code></pre></div>
<h3 id="validate-helm-chart-deployment-in-workload-clusters">Validate Helm Chart deployment in Workload clusters<a class="headerlink" href="#validate-helm-chart-deployment-in-workload-clusters" title="Permanent link">¤</a></h3>
<ol>
<li>Run the below command to get the list of Crossplane Helm Provider Objects deployed in the Management Cluster.</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl<span class="w">  </span>--context<span class="w"> </span><span class="nv">$MANAGEMENT_CLUSTER_CONTEXT</span><span class="w"> </span>get<span class="w"> </span>providerconfigs.helm.crossplane.io
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                      </span>AGE
provider-config-helm-workload-amd-1-29-blueprint<span class="w">   </span>4h37m
provider-config-helm-workload-arm-1-29-blueprint<span class="w">   </span>4h46m
</code></pre></div>
<ol>
<li>Run the below command to get the list of helm charts in the Workload Cluster  <code>workload-amd-1-29-blueprint</code></li>
</ol>
<div class="highlight"><pre><span></span><code>helm<span class="w">  </span>--kube-context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER1_CONTEXT</span><span class="w"> </span>list<span class="w"> </span>-A
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                    </span>NAMESPACE<span class="w">               </span>REVISION<span class="w">        </span>UPDATED<span class="w">                                  </span>STATUS<span class="w">          </span>CHART<span class="w">                   </span>APP<span class="w"> </span>VERSION
blueprints-addon-external-secrets<span class="w">       </span>external-secrets<span class="w">        </span><span class="m">1</span><span class="w">               </span><span class="m">2024</span>-05-07<span class="w"> </span><span class="m">05</span>:25:31.465715836<span class="w"> </span>+0000<span class="w"> </span>UTC<span class="w">  </span>deployed<span class="w">        </span>external-secrets-0.9.9<span class="w">  </span>v0.9.9<span class="w">     </span>
test-helm-workload-amd-1-29-blueprint<span class="w">            </span>default<span class="w">                 </span><span class="m">1</span><span class="w">               </span><span class="m">2024</span>-05-15<span class="w"> </span><span class="m">06</span>:39:17.325950143<span class="w"> </span>+0000<span class="w"> </span>UTC<span class="w">  </span>deployed<span class="w">        </span>nginx-17.0.1<span class="w">            </span><span class="m">1</span>.26.0<span class="w">  </span>
</code></pre></div>
<ol>
<li>Run the below command to get the list of Helm Charts in the Workload cluster  <code>workload-arm-1-29-blueprint</code></li>
</ol>
<div class="highlight"><pre><span></span><code>helm<span class="w">  </span>--kube-context<span class="w"> </span><span class="nv">$WORKLOAD_CLUSTER2_CONTEXT</span><span class="w"> </span>list<span class="w"> </span>-A
</code></pre></div>
<p>The output will look like below.</p>
<div class="highlight"><pre><span></span><code>NAME<span class="w">                                    </span>NAMESPACE<span class="w">               </span>REVISION<span class="w">        </span>UPDATED<span class="w">                                  </span>STATUS<span class="w">          </span>CHART<span class="w">                   </span>APP<span class="w"> </span>VERSION
blueprints-addon-external-secrets<span class="w">       </span>external-secrets<span class="w">        </span><span class="m">1</span><span class="w">               </span><span class="m">2024</span>-05-07<span class="w"> </span><span class="m">05</span>:26:52.028907405<span class="w"> </span>+0000<span class="w"> </span>UTC<span class="w">  </span>deployed<span class="w">        </span>external-secrets-0.9.9<span class="w">  </span>v0.9.9<span class="w">     </span>
test-helm-workload-arm-1-29-blueprint<span class="w">            </span>default<span class="w">                 </span><span class="m">1</span><span class="w">               </span><span class="m">2024</span>-05-15<span class="w"> </span><span class="m">06</span>:39:17.222351682<span class="w"> </span>+0000<span class="w"> </span>UTC<span class="w">  </span>deployed<span class="w">        </span>nginx-17.0.1<span class="w">            </span><span class="m">1</span>.26.0<span class="w">   </span>
</code></pre></div>
<h2 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">¤</a></h2>
<p>To clean up your EKS Blueprints, run the following commands:</p>
<p><div class="highlight"><pre><span></span><code>make<span class="w"> </span>pattern<span class="w"> </span>crossplane-argocd-gitops<span class="w"> </span>destroy<span class="w"> </span>
</code></pre></div>
The above command deletes the AWS CodePipeline <code>crossplane-argocd-gitops</code>. However to complete the Cleanup, delete the following CloudFormation Stacks manually using AWS Console or AWS CLI using below commands.</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>cloudformation<span class="w"> </span>delete-stack<span class="w"> </span>--stack-name<span class="w"> </span>workload-amd-1-29-workload-amd-1-29-blueprint
aws<span class="w"> </span>cloudformation<span class="w"> </span>delete-stack<span class="w"> </span>--stack-name<span class="w"> </span>workload-arm-1-29-workload-arm-1-29-blueprint
aws<span class="w"> </span>cloudformation<span class="w"> </span>delete-stack<span class="w"> </span>--stack-name<span class="w"> </span>mgmt-cluster-stage-mgmt-cluster-stage-blueprint
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>