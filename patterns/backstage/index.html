
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../batch/">
      
      
        <link rel="next" href="../custom-networking-with-ipv4/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Backstage Pattern - Amazon EKS Blueprints Patterns</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#backstage-on-eks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amazon EKS Blueprints Patterns" class="md-header__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon EKS Blueprints Patterns
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Backstage Pattern
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amazon EKS Blueprints Patterns" class="md-nav__button md-logo" aria-label="Amazon EKS Blueprints Patterns" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon EKS Blueprints Patterns
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-samples/cdk-eks-blueprints-patterns" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/cdk-eks-blueprints-patterns
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generative AI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Generative AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generative-ai/showcase/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt Showcase Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Observability Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Observability Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    New Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            New Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-native/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-graviton-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Graviton Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-opensource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-awsnative-fargate-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fargate Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/multi-acc-new-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Cluster Multi-Region Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-apiserver-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-gpu-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS GPU Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-java-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Java Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/single-new-eks-nginx-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Existing Cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Existing Cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-awsnative-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Native Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-mixed-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixed Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-opensource-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-apiserver-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Apiserver Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/existing-eks-nginx-observability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSS Nginx Monitoring
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/multi-account-monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Account Observability Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Security Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Security Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/eks-config-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS Config Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/encryption-at-rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encryption At Rest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/guardduty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GuardDuty
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/image-scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Scanning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/securityhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SecurityHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Batch Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Backstage Pattern
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Backstage Pattern
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-networking-with-ipv4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customer Network with IPV4 Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../instana/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instana Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jupyterhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyterhub Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../knoveyor.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Konveyor Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubeflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeflow Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubeshark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeshark Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline-multi-env-gitops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi environment Pipeline GitOps pattern Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-cluster-conformitron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi cluster conformitron pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nginx Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secureingresscognito/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Ingress and Authentication Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graviton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graviton Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gmaestro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gMaestro Pattern
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="backstage-on-eks">Backstage on EKS<a class="headerlink" href="#backstage-on-eks" title="Permanent link">¤</a></h1>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">¤</a></h2>
<p><a href="https://backstage.io/">Backstage</a> is an application that aims to facilitate introduction and maintenance of standards and best practices, across the organization, tying all infrastructure tooling, resources, owners, contributors, and administrators together in one place.</p>
<p>The base functionality is provided by the Core component, which is assembled together with Plugins into an Application. Plugins extend the Core with additional functionalities that can be open source, or proprietary to a company.</p>
<p>The objective of this pattern is to illustrate how to deploy a Backstage pre-built Docker image, using the <a href="https://github.com/aws-quickstart/cdk-eks-blueprints/blob/main/docs/addons/backstage.md">Amazon EKS Blueprints Backstage add-on</a>.</p>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">¤</a></h2>
<p><img alt="Backstage Architecture" src="../images/backstage-diagram.png" /></p>
<h2 id="approach">Approach<a class="headerlink" href="#approach" title="Permanent link">¤</a></h2>
<p>This blueprint will include the following:</p>
<ul>
<li>A new Well-Architected VPC with both Public and Private subnets</li>
<li>A new Well-Architected EKS cluster in the region and account you specify</li>
<li>An Application Load Balancer (ALB), implementing the Backstage Ingress rules</li>
<li>An Amazon RDS for PostgreSQL instance</li>
<li>A certificate, assigned to the ALB</li>
<li>A Secret in AWS Secrets Manager, storing the database credentials, imported into the cluster via <a href="https://aws-quickstart.github.io/cdk-eks-blueprints/addons/external-secrets/">ExternalsSecretsAddOn</a></li>
<li>Other popular add-ons</li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¤</a></h2>
<p>Ensure that you have installed the following tools on your machine:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html">aws cli</a> (also ensure it is <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-quickstart.html#getting-started-quickstart-new">configured</a>)</li>
<li><a href="https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html#getting_started_install">cdk</a></li>
<li><a href="https://docs.npmjs.com/cli/v8/commands/npm-install">npm</a></li>
<li><a href="https://www.typescriptlang.org/download">tsc</a></li>
<li><a href="https://www.gnu.org/software/make/">make</a></li>
<li><a href="https://docs.docker.com/get-docker/">Docker</a></li>
</ul>
<p>Let’s start by setting the account and region environment variables:</p>
<div class="highlight"><pre><span></span><code><span class="nv">ACCOUNT_ID</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>sts<span class="w"> </span>get-caller-identity<span class="w"> </span>--query<span class="w"> </span><span class="s1">&#39;Account&#39;</span><span class="w"> </span>--output<span class="w"> </span>text<span class="k">)</span>
<span class="nv">AWS_REGION</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>configure<span class="w"> </span>get<span class="w"> </span>region<span class="k">)</span>
</code></pre></div>
<p>Create the <a href="https://backstage.io/docs/getting-started/create-an-app">Backstage application</a>, command reported here for your convenience:</p>
<div class="highlight"><pre><span></span><code>npx<span class="w"> </span>@backstage/create-app@latest
</code></pre></div>
<p>Build the corresponding <a href="https://backstage.io/docs/deployment/docker">Docker image</a>, commands reported here for your convenience:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>./backstage
yarn<span class="w"> </span>install<span class="w"> </span>--frozen-lockfile
yarn<span class="w"> </span>tsc
yarn<span class="w"> </span>build:backend<span class="w"> </span>--config<span class="w"> </span>app-config.yaml
</code></pre></div>
<p>Note: if the above command throws an error caused by app-config.yaml not found, you can explicitly set the path to the file:</p>
<p><div class="highlight"><pre><span></span><code>yarn<span class="w"> </span>build:backend<span class="w"> </span>--config<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/app-config.yaml
</code></pre></div>
Then you can progress with the docker image build:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>image<span class="w"> </span>build<span class="w"> </span>.<span class="w"> </span>-f<span class="w"> </span>packages/backend/Dockerfile<span class="w"> </span>--tag<span class="w"> </span>backstage
</code></pre></div>
<p>Note: consider the platform you are building on, and the target platform the image will run on, you might want to use the <a href="https://docs.docker.com/engine/reference/commandline/buildx_build/">--platform option</a>, e.g.:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>buildx<span class="w"> </span>build<span class="w"> </span>...<span class="w"> </span>--platform<span class="o">=</span>...
</code></pre></div>
<p>Note: If you are running a version of Docker Engine version earlier than 23.0, you might need to enable BuildKit manually, like explained in the <a href="https://docs.docker.com/build/buildkit/#getting-started">Getting Started section</a> of the BuildKit webpage.</p>
<p>(Optional) to show examples on the UI, add to Docker file:</p>
<div class="highlight"><pre><span></span><code>COPY<span class="w"> </span>--chown<span class="o">=</span>node:node<span class="w"> </span>examples<span class="w"> </span>/examples
</code></pre></div>
<p>Create an Amazon Elastic Container Registry (ECR) repository, named <em>backstage</em>:</p>
<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>ecr<span class="w"> </span>create-repository<span class="w"> </span>--repository-name<span class="w"> </span>backstage
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nv">DOCKER_IMAGE_ID</span><span class="o">=</span>...<span class="w"> </span><span class="c1">#see output of image id from above image creation</span>
aws<span class="w"> </span>ecr<span class="w"> </span>get-login-password<span class="w"> </span>--region<span class="w"> </span><span class="nv">$AWS_REGION</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>login<span class="w"> </span>--username<span class="w"> </span>AWS<span class="w"> </span>--password-stdin<span class="w"> </span><span class="nv">$ACCOUNT_ID</span>.dkr.ecr.<span class="nv">$AWS_REGION</span>.amazonaws.com
docker<span class="w"> </span>tag<span class="w"> </span><span class="nv">$DOCKER_IMAGE_ID</span><span class="w"> </span><span class="nv">$ACCOUNT_ID</span>.dkr.ecr.<span class="nv">$AWS_REGION</span>.amazonaws.com/backstage:latest
docker<span class="w"> </span>push<span class="w"> </span><span class="nv">$ACCOUNT_ID</span>.dkr.ecr.<span class="nv">$AWS_REGION</span>.amazonaws.com/backstage:latest
</code></pre></div>
<p>Setup a Hosted Zone in Route 53, with your parent domain. The pattern will create a new subdomain with format <em>{backstage subdomain label}.{parent domain}</em>. The default value for <em>{backstage subdomain label}</em> is <em>backstage</em> (see parameters below).</p>
<h2 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">¤</a></h2>
<p>Clone the repository:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/aws-samples/cdk-eks-blueprints-patterns.git
<span class="nb">cd</span><span class="w"> </span>cdk-eks-blueprints-patterns
</code></pre></div>
<p>Set the pattern's parameters in the CDK context by overriding the <em>cdk.json</em> file (edit <em>PARENT_DOMAIN_NAME</em> as it fits):</p>
<div class="highlight"><pre><span></span><code><span class="nv">PARENT_DOMAIN_NAME</span><span class="o">=</span>example.com
<span class="nv">HOSTED_ZONE_ID</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>route53<span class="w"> </span>list-hosted-zones-by-name<span class="w"> </span>--dns-name<span class="w"> </span><span class="nv">$PARENT_DOMAIN_NAME</span><span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;HostedZones[].Id&quot;</span><span class="w"> </span>--output<span class="w"> </span>text<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>basename<span class="k">)</span>
cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; cdk.json</span>
<span class="s">{</span>
<span class="s">    &quot;app&quot;: &quot;npx ts-node dist/lib/common/default-main.js&quot;,</span>
<span class="s">    &quot;context&quot;: {</span>
<span class="s">        &quot;backstage.image.registry.name&quot;: &quot;${ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com&quot;,</span>
<span class="s">        &quot;backstage.parent.domain.name&quot;:&quot;${PARENT_DOMAIN_NAME}&quot;,</span>
<span class="s">        &quot;backstage.hosted.zone.id&quot;: &quot;${HOSTED_ZONE_ID}&quot;</span>
<span class="s">      }</span>
<span class="s">}</span>
<span class="s">EOF</span>
</code></pre></div>
<p>(Optional) The full list of parameters you can set in the <em>context</em> is:</p>
<div class="highlight"><pre><span></span><code>    &quot;context&quot;: {
        &quot;backstage.namespace.name&quot;: ...,
        &quot;backstage.image.registry.name&quot;: ...,
        &quot;backstage.image.repository.name&quot;: ...,
        &quot;backstage.image.tag.name&quot;: ...,
        &quot;backstage.parent.domain.name&quot;: ...,
        &quot;backstage.subdomain.label&quot;: ...,
        &quot;backstage.hosted.zone.id&quot;: ...,
        &quot;backstage.certificate.resource.name&quot;: ...,
        &quot;backstage.database.resource.name&quot;: ...,
        &quot;backstage.database.instance.port&quot;: ...,
        &quot;backstage.database.secret.resource.name&quot;: ...,
        &quot;backstage.database.username&quot;: ...,
        &quot;backstage.database.secret.target.name&quot;: ...,
      }
</code></pre></div>
<p>You can assign values to the above keys according to the following criteria (values are required where you don't see <em>default</em> mentioned):</p>
<ul>
<li>"backstage.namespace.name": Backstage's namespace, the default is "backstage"</li>
<li>"backstage.image.registry.name": the image registry for the Backstage Helm chart in Amazon ECR, a value similar to "youraccount.dkr.ecr.yourregion.amazonaws.com"</li>
<li>"backstage.image.repository.name": the image repository for the Backstage Helm chart, the default is "backstage"</li>
<li>"backstage.image.tag.name": the image tag, the default is "latest"</li>
<li>"backstage.parent.domain.name": the parent domain in your Hosted Zone</li>
<li>"backstage.subdomain.label": to be used as <em>{"subdomain.label"}.{"parent.domain.name"}</em>, the default is "backstage"</li>
<li>"backstage.hosted.zone.id": the Hosted zone ID (format: 20x chars/numbers)</li>
<li>"backstage.certificate.resource.name": resource name of the certificate, registered by the resource provider, the default is "backstage-certificate"</li>
<li>"backstage.database.resource.name": resource name of the database, registered by the resource provider, the default is "backstage-database"</li>
<li>"backstage.database.instance.port": the port the database will use, the default is 5432</li>
<li>"backstage.database.secret.resource.name": resource name of the database's Secret, registered by the resource provider, the default is "backstage-database-credentials"</li>
<li>"backstage.database.username": the username for the database's credentials, the default is "postgres"</li>
<li>"backstage.database.secret.target.name": the name to be used when creating the Secret, the default is "backstage-database-secret"</li>
</ul>
<p>If you haven't done it before, <a href="https://docs.aws.amazon.com/cdk/v2/guide/bootstrapping.html">bootstrap your cdk account and region</a>.</p>
<p>Run the following commands:</p>
<p><div class="highlight"><pre><span></span><code>make<span class="w"> </span>deps
make<span class="w"> </span>build
make<span class="w"> </span>pattern<span class="w"> </span>backstage<span class="w"> </span>deploy
</code></pre></div>
When deployment completes, the output will be similar to the following:</p>
<p><img alt="Backstage deployment output" src="../images/backstage-console-output.png" /></p>
<p>Navigate to the URL indicated by the first line in the output (_backstage-blueprint.BackstagebaseURL ...), you should see the screen below:</p>
<p><img alt="Backstage console" src="../images/backstage-screen.png" /></p>
<p>To see the deployed resources within the cluster, please run:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pod,svc,secrets,ingress<span class="w"> </span>-A
</code></pre></div>
<p>A sample output is shown below:</p>
<p><img alt="Backstage kubectl output" src="../images/backstage-kubectl-output.png" /></p>
<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">¤</a></h2>
<p>You can go the <a href="https://aws.amazon.com/blogs/">AWS Blog</a> to explore how to use Backstage e.g., <a href="https://aws.amazon.com/blogs/opensource/how-traveloka-uses-backstage-as-an-api-developer-portal-for-amazon-api-gateway/">as an API Developer Portal for Amazon API Gateway</a> or <a href="https://aws.amazon.com/blogs/containers/provisioning-infrastructure-using-the-aws-proton-open-source-backstage-plugin/">to provision infrastructure using AWS Proton</a>. On the Backstage website you can also see other examples of <a href="https://backstage.io/demos/">how to use and expand Backstage</a>.</p>
<h2 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">¤</a></h2>
<p>To clean up your EKS Blueprints, run the following commands:</p>
<div class="highlight"><pre><span></span><code>make<span class="w"> </span>pattern<span class="w"> </span>backstage<span class="w"> </span>destroy<span class="w"> </span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>